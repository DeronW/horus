!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("js-cookie"),require("js-base64"),require("ua-parser-js")):"function"==typeof define&&define.amd?define(["js-cookie","js-base64","ua-parser-js"],t):"object"==typeof exports?exports.Horus=t(require("js-cookie"),require("js-base64"),require("ua-parser-js")):e.Horus=t(e.JSCookie,e.JSBase64,e.UAParser)}(window,function(e,t,o){return function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}return o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},o.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=13)}([function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t){if(""!==t.id)return'//*[@id="'+t.id+'"]';if(t===document.body)return"/html/body";var o=1,n="";return Array.prototype.slice.call(t.parentNode.childNodes).forEach(function(r){r===t?((n=e(t.parentNode))&&(n+="/"),n+=t.tagName.toLowerCase()+"["+o+"]"):1===r.nodeType&&r.tagName===t.tagName&&(o+=1)}),1===o&&n&&(n=n.substr(0,n.length-3)),n}},function(t,o){t.exports=e},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r=o(1),u=(n=r)&&n.__esModule?n:{default:n};var i="__HORUS_USER_ID";t.default={geUserID:function(){var e=u.default.get(i);if(!e){e="anonym."+((new Date).getTime()/1e3+Math.random());var t=location.host.split("."),o=["*"];o[2]=t.pop(),o[1]=t.pop(),u.default.set(i,e,{expires:2555}),u.default.set(i,e,{expires:2555,domain:o.join(".")})}return e},getAccountID:function(){return u.default.get("account_id")}}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,o=0;return function(n){var r=(new Date).getTime();r-o>t&&(e(n),o=r)}}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r=o(0),u=(n=r)&&n.__esModule?n:{default:n};t.default=function(e){for(var t=!1,o=e.target,n=void 0;o&&o!=document;){if(n=o.getAttribute("ho:hover")||o.getAttribute("ho-hover")){t=!0;break}o=o.parentNode}if(t){var r=n.split(":");return{eventType:"hover",eventName:r[0],desc:r[1]||o.innerText.substr(0,20),xpath:(0,u.default)(o)}}}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r=o(0),u=(n=r)&&n.__esModule?n:{default:n};t.default=function(e){var t=e.target,o=function(e){if(e==document.body)return{eventName:"",text:"click_on_body"};var t=void 0,o=e.innerText.substr(0,20),n=function(e,t){for(var o=void 0;e&&e!=document;){if(o=e.getAttribute("ho:click")||e.getAttribute("ho-click"))return o;e=e.parentNode}}(e);if(n){var r=n.split(":");t=r[0],r[1]&&(o=r[1])}return{eventName:t,text:o}}(t);return{eventName:o.eventName,eventType:"click",desc:o.text,xpath:(0,u.default)(t),pageX:e.pageX,pageY:e.pageY}}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(o(5)),r=u(o(4));function u(e){return e&&e.__esModule?e:{default:e}}t.default={Click:n.default,Hover:r.default}},function(e,t,o){"use strict";function n(e){var t=new XMLHttpRequest;return t.open("GET",e,!0),new Promise(function(e,o){t.onload=function(){t.status<300?e():o()},t.send()})}function r(e){var t=document.createElement("img");return t.style.display="none",new Promise(function(o){t.onload=function(){document.body.removeChild(t),o()},t.src=e,document.body.appendChild(t)})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return"image"==e?r(t):n(t)},t.ImageRequest=r,t.AjaxRequest=n},function(e,o){e.exports=t},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=o(8);t.default=function(e){return"object"==(void 0===e?"undefined":n(e))&&(e=JSON.stringify(e)),r.Base64.encode(e)}},function(e,t){e.exports=o},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r=o(10),u=(n=r)&&n.__esModule?n:{default:n};t.default={Properties:function(e){var t=new u.default(e||navigator.userAgent).getResult();return{user_brand:t.device.vendor,user_explorer:t.browser.name+"/"+t.browser.version,user_model:t.device.model,user_os:t.os.name+"/"+t.os.version}}}},function(e,t,o){"use strict";
/*!
 * Horus version x.x.x
 * @license  BSD
 */},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}();o(12);var u=d(o(11)),i=d(o(9)),s=d(o(7)),a=d(o(6)),c=d(o(3)),f=d(o(2));function d(e){return e&&e.__esModule?e:{default:e}}function l(){var e;(e=window.console).log.apply(e,arguments)}var p=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._done=!1,this.opt=Object.assign({url:"",project:"Empty",account_id:f.default.getAccountID(),debug:!1,request_type:"auto",listen:{click:!0,hover:!0,history:!1,scroll:!1}},t),this.listners={click:[a.default.Click],hover:[a.default.Hover],history:[a.default.History],scroll:[]}}return r(e,[{key:"_setOption",value:function(e,t){this.opt.hasOwnProperty(e)?this.opt[e]=t:l("Horus config: "+e+" has been ignored")}},{key:"setConfig",value:function(e,t){var o="object"===(void 0===e?"undefined":n(e))?e:function(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}({},e,t);for(var r in o)this._setOption(r,o[r])}},{key:"ready",value:function(e){"complete"===document.readyState?e():document.addEventListener("DOMContentLoaded",function(){e()},!1)}},{key:"observe",value:function(){this.observer=new MutationObserver(function(e){e.forEach(function(e){l(e.target),l(e.addedNodes),l(e.removedNodes)})}),this.observer.observe(document.body,{childList:!0,attributes:!0,subtree:!0})}},{key:"addListener",value:function(e,t){if(!this.listners[e])throw Error("Horus: 没有这种监听类型");this.listners[e].push(t)}},{key:"dispatch",value:function(e,t){var o=this;(this.listners[e]||[]).forEach(function(n){if("function"==typeof n){var r=n(t);r&&o._report(r.eventName||e,r)}})}},{key:"start",value:function(){var e=this;if(this._done)throw Error("Horus 不能重复监听全局事件");return this._done=!0,this.opt.listen.click&&document.addEventListener("click",function(t){return e.dispatch("click",t)}),this.opt.listen.hover&&document.addEventListener("mouseover",(0,c.default)(function(e){this.dispatch("hover",e)}.bind(this),300)),this}},{key:"decorator",value:function(e,t){var o=t||{};"object"!=(void 0===o?"undefined":n(o))&&(o={msg:String(t)});var r={time:(new Date).getTime(),project:this.opt.project,event_id:(new Date).getTime()+"-"+Math.random().toString().substr(2),event:e,properties:Object.assign({cookie:"",account_id:f.default.getAccountID(),user_id:f.default.geUserID()},u.default.Properties()),custom:o};return r.custom.eventType&&(r.event_type=r.custom.eventType),this.opt.debug&&(l("Horus reporting: ",r),l(r.custom&&r.custom.xpath)),r}},{key:"occur",value:function(e,t){this._report(e,t)}},{key:"_report",value:function(e,t){var o=this.opt.url;o.indexOf("?")<0&&(o+="?"),o+="&data="+(0,i.default)(this.decorator(e,t)),o+="&_="+(new Date).getTime(),(0,s.default)(this.request_type,o)}}]),e}();t.default=p}])});