!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("js-cookie"),require("ua-parser-js"),require("js-base64")):"function"==typeof define&&define.amd?define(["js-cookie","ua-parser-js","js-base64"],t):"object"==typeof exports?exports.Horus=t(require("js-cookie"),require("ua-parser-js"),require("js-base64")):e.Horus=t(e.JSCookie,e.UAParser,e.JSBase64)}(window,(function(e,t,o){return function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}return o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=4)}([function(t,o){t.exports=e},function(e,o){e.exports=t},function(e,t){e.exports=o},function(e,t){
/*!
 * Horus version x.x.x
 * @license  BSD
 */},function(e,t,o){"use strict";o.r(t);o(3);var n=o(1),r=o.n(n);var i={Properties:function(e){var t=new r.a(e||navigator.userAgent).getResult();return{user_brand:t.device.vendor,user_explorer:t.browser.name+"/"+t.browser.version,user_model:t.device.model,user_os:t.os.name+"/"+t.os.version}}},u=o(2);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var s=function(e){return"object"==c(e)&&(e=JSON.stringify(e)),u.Base64.encodeURI(e)};function a(e,t){return"image"==e?function(e){var t=document.createElement("img");return t.style.display="none",new Promise((function(o){t.onload=function(){document.body.removeChild(t),o()},t.src=e,document.body.appendChild(t)}))}(t):function(e){var t=new XMLHttpRequest;return t.open("GET",e,!0),new Promise((function(e,o){t.onload=function(){t.status<300?e():o()},t.send()}))}(t)}var f=function e(t){if(""!==t.id)return'//*[@id="'.concat(t.id,'"]');if(t===document.body)return"/html/body";var o=1,n="";return Array.prototype.slice.call(t.parentNode.childNodes).forEach((function(r){r===t?((n=e(t.parentNode))&&(n+="/"),n+=t.tagName.toLowerCase()+"["+o+"]"):1===r.nodeType&&r.tagName===t.tagName&&(o+=1)})),1===o&&n&&(n=n.substr(0,n.length-3)),n};var p={Click:function(e){var t=e.target,o=function(e){if(e==document.body)return{eventName:"",text:"click_on_body"};var t,o=(e.innerText||"").substr(0,20),n=function(e,t){var o;for(;e&&e!=document;){if(o=e.getAttribute("ho:click")||e.getAttribute("ho-click"))return o;e=e.parentNode}}(e);if(n){var r=n.split(":");t=r[0],r[1]&&(o=r[1])}return{eventName:t,text:o}}(t);return{eventName:o.eventName,eventType:"click",desc:o.text,xpath:f(t),pageX:e.pageX,pageY:e.pageY}},Hover:function(e){for(var t,o=!1,n=e.target;n&&n!=document;){if(t=n.getAttribute("ho:hover")||n.getAttribute("ho-hover")){o=!0;break}n=n.parentNode}if(o){var r=t.split(":");return{eventType:"hover",eventName:r[0],desc:r[1]||(n.innerText||"").substr(0,20),xpath:f(n)}}}};var l=o(0),d=o.n(l),v="__HORUS_USER_ID";var y={geUserID:function(){var e=d.a.get(v);if(!e){e="anonym."+((new Date).getTime()/1e3+Math.random());var t=location.host.split("."),o=["*"];o[2]=t.pop(),o[1]=t.pop(),d.a.set(v,e,{expires:2555}),d.a.set(v,e,{expires:2555,domain:o.join(".")})}return e},getAccountID:function(){return d.a.get("account_id")}};function b(e){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function h(){var e;(e=window.console).log.apply(e,arguments)}var g=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._done=!1,this.opt=Object.assign({url:"",project:"Empty",account_id:y.getAccountID(),debug:!1,noDescribe:!1,request_type:"auto",listen:{click:!0,hover:!0,history:!1,scroll:!1}},t),this.listners={click:[p.Click],hover:[p.Hover],history:[p.History],scroll:[]}}var t,o,n;return t=e,(o=[{key:"_setOption",value:function(e,t){Object.prototype.hasOwnProperty.call(this.opt,e)?this.opt[e]=t:h("Horus config: ".concat(e," has been ignored"))}},{key:"setConfig",value:function(e,t){var o="object"===b(e)?e:function(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}({},e,t);for(var n in o)this._setOption(n,o[n])}},{key:"ready",value:function(e){"complete"===document.readyState?e():document.addEventListener("DOMContentLoaded",(function(){e()}),!1)}},{key:"observe",value:function(){this.observer=new MutationObserver((function(e){e.forEach((function(e){h(e.target),h(e.addedNodes),h(e.removedNodes)}))})),this.observer.observe(document.body,{childList:!0,attributes:!0,subtree:!0})}},{key:"addListener",value:function(e,t){if(!this.listners[e])throw Error("Horus: 没有这种监听类型");this.listners[e].push(t)}},{key:"dispatch",value:function(e,t){var o=this;(this.listners[e]||[]).forEach((function(n){if("function"==typeof n){var r=n(t);r&&o._report(r.eventName||e,r)}}))}},{key:"start",value:function(){var e=this;if(this._done)throw Error("Horus 不能重复监听全局事件");return this._done=!0,this.opt.listen.click&&document.addEventListener("click",(function(t){return e.dispatch("click",t)})),this.opt.listen.hover&&document.addEventListener("mouseover",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,o=0;return function(n){var r=(new Date).getTime();r-o>t&&(e(n),o=r)}}(function(e){this.dispatch("hover",e)}.bind(this),300)),this}},{key:"decorator",value:function(e,t){var o=t||{};"object"!=b(o)&&(o={msg:String(t)}),this.opt.noDescribe&&delete o.desc;var n={time:(new Date).getTime(),project:this.opt.project,event_id:(new Date).getTime()+"-"+Math.random().toString().substr(2),event:e,properties:Object.assign({cookie:"",account_id:y.getAccountID(),user_id:y.geUserID()},i.Properties()),custom:o};return n.custom.eventType&&(n.event_type=n.custom.eventType),this.opt.debug&&(h("Horus reporting: ",n),h(n.custom&&n.custom.xpath)),n}},{key:"occur",value:function(e,t){this._report(e,t)}},{key:"_report",value:function(e,t){var o=this.opt.url;o.indexOf("?")<0&&(o+="?"),o+="&data="+s(this.decorator(e,t)),o+="&_="+(new Date).getTime(),a(this.request_type,o)}}])&&m(t.prototype,o),n&&m(t,n),e}();t.default=g}])}));