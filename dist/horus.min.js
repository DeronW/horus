!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("js-cookie"),require("js-base64"),require("ua-parser-js")):"function"==typeof define&&define.amd?define(["js-cookie","js-base64","ua-parser-js"],t):"object"==typeof exports?exports.Horus=t(require("js-cookie"),require("js-base64"),require("ua-parser-js")):e.Horus=t(e.JSCookie,e.JSBase64,e.UAParser)}(window,function(e,t,r){return function(e){var t={};function r(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=13)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t){if(""!==t.id)return'//*[@id="'+t.id+'"]';if(t===document.body)return"/html/body";var r=1,o="";return Array.prototype.slice.call(t.parentNode.childNodes).forEach(function(n){n===t?((o=e(t.parentNode))&&(o+="/"),o+=t.tagName.toLowerCase()+"["+r+"]"):1===n.nodeType&&n.tagName===t.tagName&&(r+=1)}),1===r&&o&&(o=o.substr(0,o.length-3)),o}},function(t,r){t.exports=e},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,n=r(1),u=(o=n)&&o.__esModule?o:{default:o};var i="__HORUS_USER_ID";t.default={geUserID:function(){var e=u.default.get(i);if(!e){e="anonym."+((new Date).getTime()/1e3+Math.random());var t=location.host.split("."),r=["*"];r[2]=t.pop(),r[1]=t.pop(),u.default.set(i,e,{expires:2555,domain:r.join(".")})}return e},getAccountID:function(){return u.default.get("account_id")}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,r=0;return function(o){var n=(new Date).getTime();n-r>t&&(e(o),r=n)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,n=r(0),u=(o=n)&&o.__esModule?o:{default:o};t.default=function(e){for(var t,r=!1,o=e.target;o&&o!=document;){if(o.getAttribute("data-horus")){r=!0;break}o=o.parentNode}if(r)return{event:"hover",title:(t=e.target,t.innerText),desc:(e.target,"TODO"),xpath:(0,u.default)(e.target)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,n=r(0),u=(o=n)&&o.__esModule?o:{default:o};t.default=function(e){e.target;var t=function(e){if(e==document.body)return{mark:"click:body",text:"pointless click"};var t=void 0,r=e.innerText.substr(0,20),o=function(e,t){for(;e&&e!=document;){var r=e.getAttribute("ho-click");if(r)return r;e=e.parentNode}}(e);if(o){var n=o.split(":");t=n[0],n[1]&&(r=n[1])}return{mark:"click"+(t?":"+t:""),text:r}}(e.target);return{mark:t.mark,desc:t.text,xpath:(0,u.default)(e.target),pageX:e.pageX,pageY:e.pageY}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=u(r(5)),n=u(r(4));function u(e){return e&&e.__esModule?e:{default:e}}t.default={Click:o.default,Hover:n.default}},function(e,t,r){"use strict";function o(e){var t=new XMLHttpRequest;return t.open("GET",e,!0),new Promise(function(e,r){t.onload=function(){t.status<300?e():r()},t.send()})}function n(e){var t=document.createElement("img");return t.style.display="none",new Promise(function(r){t.onload=function(){document.body.removeChild(t),r()},t.src=e,document.body.appendChild(t)})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return"image"==e?n(t):o(t)},t.ImageRequest=n,t.AjaxRequest=o},function(e,r){e.exports=t},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=r(8);t.default=function(e){return"object"==(void 0===e?"undefined":o(e))&&(e=JSON.stringify(e)),n.Base64.encode(e)}},function(e,t){e.exports=r},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,n=r(10),u=(o=n)&&o.__esModule?o:{default:o};t.default={Properties:function(e){var t=new u.default(e||navigator.userAgent).getResult();return{user_brand:t.device.vendor,user_explorer:t.browser.name+"/"+t.browser.version,user_model:t.device.model,user_os:t.os.name+"/"+t.os.version}}}},function(e,t,r){"use strict";
/*!
 * Horus version x.x.x
 * @license  BSD
 */},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}();r(12);var u=d(r(11)),i=d(r(9)),a=d(r(7)),s=d(r(6)),c=d(r(3)),f=d(r(2));function d(e){return e&&e.__esModule?e:{default:e}}function l(){var e;(e=window.console).log.apply(e,arguments)}var p=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._done=!1,this.opt=Object.assign({url:"",project:"Empty",account_id:f.default.getAccountID(),debug:!1,request_type:"auto",listen:{click:!0,hover:!0,history:!1,scroll:!1}},t),this.listners={click:[s.default.Click],hover:[s.default.Hover],history:[s.default.History],scroll:[]}}return n(e,[{key:"_setOption",value:function(e,t){this.opt.hasOwnProperty(e)?this.opt[e]=t:l("Horus config: "+e+" has been ignored")}},{key:"setConfig",value:function(e,t){var r="object"===(void 0===e?"undefined":o(e))?e:function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({},e,t);for(var n in r)this._setOption(n,r[n])}},{key:"ready",value:function(e){"complete"===document.readyState?e():document.addEventListener("DOMContentLoaded",function(){e()},!1)}},{key:"observe",value:function(){this.observer=new MutationObserver(function(e){e.forEach(function(e){l(e.target),l(e.addedNodes),l(e.removedNodes)})}),this.observer.observe(document.body,{childList:!0,attributes:!0,subtree:!0})}},{key:"addListener",value:function(e,t){if(!this.listners[e])throw Error("Horus: 没有这种监听类型");this.listners[e].push(t)}},{key:"dispatch",value:function(e,t){var r=this;(this.listners[e]||[]).forEach(function(o){if("function"==typeof o){var n=o(t);n&&r._report(e,n)}})}},{key:"start",value:function(){var e=this;if(this._done)throw Error("Horus 不能重复监听全局事件");return this._done=!0,this.opt.listen.click&&document.addEventListener("click",function(t){return e.dispatch("click",t)}),this.opt.listen.hover&&document.addEventListener("mouseover",(0,c.default)(function(e){this.dispatch("hover",e)}.bind(this),300)),this}},{key:"decorator",value:function(e,t){var r={time:(new Date).getTime(),project:this.opt.project,event_id:(new Date).getTime()+"-"+Math.random().toString().substr(2),event:e,properties:Object.assign({cookie:"",account_id:f.default.getAccountID(),user_id:f.default.geUserID()},u.default.Properties()),custom:t};if(r.custom.mark){var o=r.custom.mark.split(":");o[0]&&(r.event_type=o[0])}return this.opt.debug&&(l("Horus reporting: ",r),l(r.custom.xpath)),r}},{key:"occur",value:function(e,t){this._report(e,t)}},{key:"_report",value:function(e,t){var r=this.opt.url;r.indexOf("?")<0&&(r+="?"),r+="&data="+(0,i.default)(this.decorator(e,t)),r+="&_="+(new Date).getTime(),(0,a.default)(this.request_type,r)}}]),e}();t.default=p}])});