!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("js-cookie"),require("js-base64"),require("ua-parser-js")):"function"==typeof define&&define.amd?define(["js-cookie","js-base64","ua-parser-js"],t):"object"==typeof exports?exports.Horus=t(require("js-cookie"),require("js-base64"),require("ua-parser-js")):e.Horus=t(e.JSCookie,e.JSBase64,e.UAParser)}(window,function(e,t,n){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=13)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t){if(""!==t.id)return'//*[@id="'+t.id+'"]';if(t===document.body)return"/html/body";var n=1,o="";return Array.prototype.slice.call(t.parentNode.childNodes).forEach(function(r){r===t?((o=e(t.parentNode))&&(o+="/"),o+=t.tagName.toLowerCase()+"["+n+"]"):1===r.nodeType&&r.tagName===t.tagName&&(n+=1)}),1===n&&o&&(o=o.substr(0,o.length-3)),o}},function(t,n){t.exports=e},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){return e&&e.__esModule?e:{default:e}}(n(1));var r="__HORUS_USER_ID";t.default={geUserID:function(){var e=o.default.get(r);if(!e){e="anonym."+((new Date).getTime()/1e3+Math.random());var t=location.host.split("."),n=["*"];n[2]=t.pop(),n[1]=t.pop(),o.default.set(r,e,{expires:2555}),o.default.set(r,e,{expires:2555,domain:n.join(".")})}return e},getAccountID:function(){return o.default.get("account_id")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,n=0;return function(o){var r=(new Date).getTime();r-n>t&&(e(o),n=r)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){return e&&e.__esModule?e:{default:e}}(n(0));t.default=function(e){for(var t=!1,n=e.target,r=void 0;n&&n!=document;){if(r=n.getAttribute("ho:hover")||n.getAttribute("ho-hover")){t=!0;break}n=n.parentNode}if(t){var u=r.split(":");return{eventType:"hover",eventName:u[0],desc:u[1]||(n.innerText||"").substr(0,20),xpath:(0,o.default)(n)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){return e&&e.__esModule?e:{default:e}}(n(0));t.default=function(e){var t=e.target,n=function(e){if(e==document.body)return{eventName:"",text:"click_on_body"};var t=void 0,n=(e.innerText||"").substr(0,20),o=function(e,t){for(var n=void 0;e&&e!=document;){if(n=e.getAttribute("ho:click")||e.getAttribute("ho-click"))return n;e=e.parentNode}}(e);if(o){var r=o.split(":");t=r[0],r[1]&&(n=r[1])}return{eventName:t,text:n}}(t);return{eventName:n.eventName,eventType:"click",desc:n.text,xpath:(0,o.default)(t),pageX:e.pageX,pageY:e.pageY}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=u(n(5)),r=u(n(4));function u(e){return e&&e.__esModule?e:{default:e}}t.default={Click:o.default,Hover:r.default}},function(e,t,n){"use strict";function o(e){var t=new XMLHttpRequest;return t.open("GET",e,!0),new Promise(function(e,n){t.onload=function(){t.status<300?e():n()},t.send()})}function r(e){var t=document.createElement("img");return t.style.display="none",new Promise(function(n){t.onload=function(){document.body.removeChild(t),n()},t.src=e,document.body.appendChild(t)})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return"image"==e?r(t):o(t)},t.ImageRequest=r,t.AjaxRequest=o},function(e,n){e.exports=t},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=n(8);t.default=function(e){return"object"==(void 0===e?"undefined":o(e))&&(e=JSON.stringify(e)),r.Base64.encodeURI(e)}},function(e,t){e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){return e&&e.__esModule?e:{default:e}}(n(10));t.default={Properties:function(e){var t=new o.default(e||navigator.userAgent).getResult();return{user_brand:t.device.vendor,user_explorer:t.browser.name+"/"+t.browser.version,user_model:t.device.model,user_os:t.os.name+"/"+t.os.version}}}},function(e,t,n){"use strict";
/*!
 * Horus version x.x.x
 * @license  BSD
 */},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();n(12);var u=d(n(11)),i=d(n(9)),s=d(n(7)),a=d(n(6)),c=d(n(3)),f=d(n(2));function d(e){return e&&e.__esModule?e:{default:e}}function l(){var e;(e=window.console).log.apply(e,arguments)}var p=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._done=!1,this.opt=Object.assign({url:"",project:"Empty",account_id:f.default.getAccountID(),debug:!1,noDescribe:!1,request_type:"auto",listen:{click:!0,hover:!0,history:!1,scroll:!1}},t),this.listners={click:[a.default.Click],hover:[a.default.Hover],history:[a.default.History],scroll:[]}}return r(e,[{key:"_setOption",value:function(e,t){this.opt.hasOwnProperty(e)?this.opt[e]=t:l("Horus config: "+e+" has been ignored")}},{key:"setConfig",value:function(e,t){var n="object"===(void 0===e?"undefined":o(e))?e:function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},e,t);for(var r in n)this._setOption(r,n[r])}},{key:"ready",value:function(e){"complete"===document.readyState?e():document.addEventListener("DOMContentLoaded",function(){e()},!1)}},{key:"observe",value:function(){this.observer=new MutationObserver(function(e){e.forEach(function(e){l(e.target),l(e.addedNodes),l(e.removedNodes)})}),this.observer.observe(document.body,{childList:!0,attributes:!0,subtree:!0})}},{key:"addListener",value:function(e,t){if(!this.listners[e])throw Error("Horus: 没有这种监听类型");this.listners[e].push(t)}},{key:"dispatch",value:function(e,t){var n=this;(this.listners[e]||[]).forEach(function(o){if("function"==typeof o){var r=o(t);r&&n._report(r.eventName||e,r)}})}},{key:"start",value:function(){var e=this;if(this._done)throw Error("Horus 不能重复监听全局事件");return this._done=!0,this.opt.listen.click&&document.addEventListener("click",function(t){return e.dispatch("click",t)}),this.opt.listen.hover&&document.addEventListener("mouseover",(0,c.default)(function(e){this.dispatch("hover",e)}.bind(this),300)),this}},{key:"decorator",value:function(e,t){var n=t||{};"object"!=(void 0===n?"undefined":o(n))&&(n={msg:String(t)}),this.opt.noDescribe&&delete n.desc;var r={time:(new Date).getTime(),project:this.opt.project,event_id:(new Date).getTime()+"-"+Math.random().toString().substr(2),event:e,properties:Object.assign({cookie:"",account_id:f.default.getAccountID(),user_id:f.default.geUserID()},u.default.Properties()),custom:n};return r.custom.eventType&&(r.event_type=r.custom.eventType),this.opt.debug&&(l("Horus reporting: ",r),l(r.custom&&r.custom.xpath)),r}},{key:"occur",value:function(e,t){this._report(e,t)}},{key:"_report",value:function(e,t){var n=this.opt.url;n.indexOf("?")<0&&(n+="?"),n+="&data="+(0,i.default)(this.decorator(e,t)),n+="&_="+(new Date).getTime(),(0,s.default)(this.request_type,n)}}]),e}();t.default=p}])});